# ๐ ุฑุงูููุง ุณุฑุน ุฑุงูโุงูุฏุงุฒ ุณุณุชู B2B

ุงู ุฑุงูููุง ูุฑุงุญู ุฑุงูโุงูุฏุงุฒ ุณุฑุน ุณุณุชู ุณูุณููโูุฑุงุชุจ ู ููุชโฺฏุฐุงุฑ ฺูุฏูุงู ุฑุง ุชูุถุญ ูโุฏูุฏ.

---

## ๐ฆ ูพุดโูุงุฒูุง

- Node.js 20.18.1+
- pnpm 9.15.1+
- PostgreSQL 16.6+
- Redis 7.4+

---

## โก ูุตุจ ุณุฑุน

### 1๏ธโฃ ูุตุจ Dependencies

```bash
pnpm install
```

### 2๏ธโฃ ุชูุธู ุฏุชุงุจุณ

```bash
# ุงุฌุงุฏ ู ุงุนูุงู migrations
pnpm run prisma:migrate

# ุชููุฏ Prisma Client
pnpm run prisma:generate

# ุงุถุงูู ฺฉุฑุฏู ุฏุงุฏูโูุง ุงููู (seed)
pnpm run prisma:seed
```

### 3๏ธโฃ ุฑุงูโุงูุฏุงุฒ ุณุฑูุณโูุง

```bash
# ุจุง Docker Compose
docker compose up -d postgres redis

# ุง ุจู ุตูุฑุช ุฏุณุช PostgreSQL ู Redis ุฑุง ุฑุงูโุงูุฏุงุฒ ฺฉูุฏ
```

### 4๏ธโฃ ุงุฌุฑุง Backend (API)

```bash
cd apps/api
pnpm run dev
```

API ุฏุฑ `http://localhost:3001` ุฏุฑ ุฏุณุชุฑุณ ุงุณุช.

### 5๏ธโฃ ุงุฌุฑุง Frontend (Web)

```bash
cd apps/web
pnpm run dev
```

ูุจโุณุงุช ุฏุฑ `http://localhost:3000` ุฏุฑ ุฏุณุชุฑุณ ุงุณุช.

---

## ๐งช ุชุณุช ุณุฑุน

### ุงุฌุงุฏ ฺฉุงุฑุฎุงูู (Organization)

```bash
curl -X POST http://localhost:3001/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "factory@example.com",
    "password": "Pass1234!",
    "mobile": "09123456789",
    "firstName": "ฺฉุงุฑุฎุงูู",
    "lastName": "ุชูุฑุงู"
  }'
```

### ูุฑูุฏ ู ุฏุฑุงูุช Token

```bash
curl -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "factory@example.com",
    "password": "Pass1234!"
  }'
```

### ุงุฌุงุฏ ููุงูุฏู

```bash
TOKEN="your_jwt_token_here"

curl -X POST http://localhost:3001/api/hierarchy/agents \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "ููุงูุฏฺฏ ุงุตููุงู",
    "mobile": "09191234567",
    "email": "isfahan@example.com",
    "tierLevel": "GOLD",
    "creditLimit": 1000000000,
    "discountPercentage": 5
  }'
```

---

## ๐ ุฏุงุฏูโูุง ููููู

### ุณุทูุญ ููุชโฺฏุฐุงุฑ ูพุดโูุฑุถ

| Tier Level | ุชุฎูู | ุชูุถุญุงุช |
|-----------|-------|---------|
| GOLD      | 25%   | ููุงูุฏฺฏุงู ุทูุง |
| SILVER    | 15%   | ููุงูุฏฺฏุงู ููุฑูโุง |
| BRONZE    | 5%    | ููุงูุฏฺฏุงู ุจุฑูุฒ |

### ููุดโูุง ฺฉุงุฑุจุฑ

- `SELLER`: ฺฉุงุฑุฎุงูู (ูโุชูุงูุฏ ููุงูุฏู ุงุฌุงุฏ ฺฉูุฏ)
- `EXECUTOR`: ูุฌุฑ (ููููโฺฉุดุ ุจุฑูฺฉุงุฑุ ูพูุงูฺฉุงุฑ)

---

## ๐ ุฏุณุชุฑุณ ุจู ุตูุญุงุช

| ููุด | ูุณุฑ | ุชูุถุญุงุช |
|-----|------|---------|
| ฺฉุงุฑุฎุงูู | `/panel/factory/agents` | ูุฏุฑุช ููุงูุฏฺฏุงู |
| ููุงูุฏู | `/panel/catalog` | ฺฉุงุชุงููฺฏ ูุญุตููุงุช ุจุง ููุช ูฺู |
| ูุฌุฑ | `/panel/executor/quick-order` | ุณูุงุฑุด ุณุฑุน |

---

## ๐ง ุชูุธูุงุช .env

ูุงู `.env` ุฑุง ุฏุฑ ุฑุดู ูพุฑูฺู ุงุฌุงุฏ ฺฉูุฏ:

```env
# Database
DATABASE_URL="postgresql://user:password@localhost:5432/nextgen_market"

# Redis
REDIS_URL="redis://localhost:6379"

# JWT
JWT_SECRET="your-super-secret-key-change-this-in-production"

# Server
PORT=3001
NODE_ENV=development
```

---

## ๐ฑ ุงุณุชูุงุฏู ุงุฒ UI

### 1. ฺฉุงุฑุฎุงูู

1. **ุซุจุชโูุงู / ูุฑูุฏ:**
   - ุจู `/auth/login` ุจุฑูุฏ
   - ุจุง ุงูู ู ุฑูุฒ ุนุจูุฑ ูุงุฑุฏ ุดูุฏ

2. **ูุฏุฑุช ููุงูุฏฺฏุงู:**
   - ุจู `/panel/factory/agents` ุจุฑูุฏ
   - ุฑู "โ ุงูุฒูุฏู ููุงูุฏู ุฌุฏุฏ" ฺฉูฺฉ ฺฉูุฏ
   - ูุฑู ุฑุง ูพุฑ ฺฉูุฏ:
     - ูุงู ููุงูุฏู
     - ุดูุงุฑู ููุจุงู (09xxxxxxxxx)
     - ุงูู (ุงุฎุชุงุฑ)
     - ุณุทุญ ููุช (ุทูุง/ููุฑูโุง/ุจุฑูุฒ)
     - ุณูู ุงุนุชุจุงุฑ (ุฑุงู)
     - ุชุฎูู ุงุถุงู (ุฏุฑุตุฏ)
   - ุฑู "โ ุงุฌุงุฏ ููุงูุฏู" ฺฉูฺฉ ฺฉูุฏ

3. **ููุงูุฏู ฺฉ SMS ุจุง ุฑูุฒ ูููุช ุฏุฑุงูุช ูโฺฉูุฏ**

### 2. ููุงูุฏู

1. **ูุฑูุฏ:**
   - ุจุง ููุจุงู ู ุฑูุฒ ูููุช ูุงุฑุฏ ุดูุฏ
   - ุฑูุฒ ุนุจูุฑ ุฎูุฏ ุฑุง ุชุบุฑ ุฏูุฏ

2. **ูุดุงูุฏู ฺฉุงุชุงููฺฏ:**
   - ุจู `/panel/catalog` ุจุฑูุฏ
   - ูุญุตููุงุช ุจุง ููุช ูฺู ููุงุด ุฏุงุฏู ูโุดููุฏ
   - ููุช ุงุตู ุฎุทโุฎูุฑุฏู ููุงุด ุฏุงุฏู ูโุดูุฏ

3. **ุฎุฑุฏ:**
   - ุฑู ูุญุตูู ฺฉูฺฉ ฺฉูุฏ
   - "ุงูุฒูุฏู ุจู ุณุจุฏ" ุฑุง ุจุฒูุฏ

### 3. ูุฌุฑ

1. **ุณูุงุฑุด ุณุฑุน:**
   - ุจู `/panel/executor/quick-order` ุจุฑูุฏ
   - ุฏุฑ ุฌุฏููุ ุชุนุฏุงุฏ ูุญุตููุงุช ุฑุง ูุงุฑุฏ ฺฉูุฏ
   - ููุช ฺฉู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ูุญุงุณุจู ูโุดูุฏ

2. **ุตุฏูุฑ ูพุดโูุงฺฉุชูุฑ:**
   - ุฑู "๐ ุตุฏูุฑ ูพุดโูุงฺฉุชูุฑ" ฺฉูฺฉ ฺฉูุฏ
   - ูพุดโูุงฺฉุชูุฑ ุจุฑุง ุนูุฏูโูุฑูุด ุงุฑุณุงู ูโุดูุฏ

---

## ๐ ุฑูุน ูุดฺฉูุงุช ุฑุงุฌ

### ุฎุทุง "Cannot connect to database"
```bash
# ุจุฑุฑุณ ฺฉูุฏ PostgreSQL ุฏุฑ ุญุงู ุงุฌุฑุง ุงุณุช
docker compose ps

# ุงฺฏุฑ ุฎุงููุด ุจูุฏุ ุฑูุดู ฺฉูุฏ
docker compose up -d postgres
```

### ุฎุทุง "Port 3001 already in use"
```bash
# Port ุฏฺฏุฑ ุงุณุชูุงุฏู ฺฉูุฏ
PORT=3002 pnpm run dev
```

### ุฎุทุง "Prisma Client not generated"
```bash
pnpm run prisma:generate
```

### ูุญุตููุงุช ููุงุด ุฏุงุฏู ููโุดููุฏ
```bash
# ุฏุงุฏูโูุง ููููู ุฑุง ุงุถุงูู ฺฉูุฏ
pnpm run prisma:seed
```

---

## ๐ ูุณุชูุฏุงุช ุจุดุชุฑ

- [ุฑุงูููุง ฺฉุงูู B2B](./B2B_HIERARCHY_GUIDE.md)
- [API Documentation](../contracts/api.yaml)
- [Database Schema](../prisma/schema.prisma)

---

## ๐ฏ ฺฺฉโูุณุช ุฑุงูโุงูุฏุงุฒ

- [ ] Node.js ู pnpm ูุตุจ ุดุฏู
- [ ] PostgreSQL ู Redis ุฏุฑ ุญุงู ุงุฌุฑุง ูุณุชูุฏ
- [ ] Dependencies ูุตุจ ุดุฏู (`pnpm install`)
- [ ] Migrations ุงุนูุงู ุดุฏู (`pnpm run prisma:migrate`)
- [ ] Prisma Client ุชููุฏ ุดุฏู (`pnpm run prisma:generate`)
- [ ] Backend ุฏุฑ ุญุงู ุงุฌุฑุง ุงุณุช (`http://localhost:3001`)
- [ ] Frontend ุฏุฑ ุญุงู ุงุฌุฑุง ุงุณุช (`http://localhost:3000`)
- [ ] ูโุชูุงูุฏ ูุงุฑุฏ `/auth/login` ุดูุฏ
- [ ] ูโุชูุงูุฏ ููุงูุฏู ุงุฌุงุฏ ฺฉูุฏ

---

## ๐ ุขูุงุฏู ุงุณุชูุฑุงุฑุ

ุจุฑุง ุงุณุชูุฑุงุฑ ุฏุฑ production:

```bash
# ุณุงุฎุช ูพุฑูฺู
pnpm run build

# ุงุฌุฑุง production
NODE_ENV=production pnpm start
```

ุง ุจุง Docker:

```bash
docker compose -f docker-compose.prod.yml up -d
```

---

## ๐ก ูฺฉุงุช ููู

1. **ุงููุช:**
   - `JWT_SECRET` ุฑุง ุญุชูุงู ุชุบุฑ ุฏูุฏ
   - ุงุฒ HTTPS ุงุณุชูุงุฏู ฺฉูุฏ
   - ุฑูุฒูุง ูููุช ุฑุง ุงุฒ ุทุฑู SMS ุงุฑุณุงู ฺฉูุฏ

2. **ุนููฺฉุฑุฏ:**
   - ุงุฒ Redis ุจุฑุง ฺฉุด ุงุณุชูุงุฏู ุดุฏู
   - Indexes ุจุฑ ุฑู ุฌุฏุงูู ููู ุชุนุฑู ุดุฏู

3. **ููุงุณโูพุฐุฑ:**
   - ุงุฒ Connection Pooling ุงุณุชูุงุฏู ฺฉูุฏ
   - Horizontal scaling ุจุง Load Balancer

---

**โ ุณุณุชู ุดูุง ุขูุงุฏู ุงุณุช!**

ุจุฑุง ุณูุงูุงุช: `support@nextgen-market.ir`
