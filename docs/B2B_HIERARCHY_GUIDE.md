# ๐ญ B2B Hierarchy & Tiered Pricing System

ุณุณุชู ุณูุณููโูุฑุงุชุจ ู ููุชโฺฏุฐุงุฑ ฺูุฏูุงู ุจุฑุง ูุงุฑฺฉุชโูพูุณ B2B

---

## ๐ ููุฑุณุช ูุทุงูุจ

1. [ูุนูุงุฑ ุณุณุชู](#ูุนูุงุฑ-ุณุณุชู)
2. [API Endpoints](#api-endpoints)
3. [ุตูุญุงุช Frontend](#ุตูุญุงุช-frontend)
4. [ูุญูู ุงุณุชูุงุฏู](#ูุญูู-ุงุณุชูุงุฏู)
5. [ูุฏู ุฏุงุฏู](#ูุฏู-ุฏุงุฏู)

---

## ๐๏ธ ูุนูุงุฑ ุณุณุชู

### ุณูุณููโูุฑุงุชุจ ุณุงุฒูุงู

```
ฺฉุงุฑุฎุงูู (FACTORY)
    โ
ุนูุฏูโูุฑูุด/ููุงูุฏู (AGENT)
    โ
ูุฌุฑ (EXECUTOR)
```

### ุณุทูุญ ููุชโฺฏุฐุงุฑ (Tiered Pricing)

| ุณุทุญ | ุชุฎูู ูพุดโูุฑุถ | ุชูุถุญุงุช |
|-----|---------------|---------|
| ๐ฅ GOLD | 25% | ุจุงูุงุชุฑู ุชุฎูู ุจุฑุง ููุงูุฏฺฏุงู ุทูุง |
| ๐ฅ SILVER | 15% | ุชุฎูู ูุชูุณุท ุจุฑุง ููุงูุฏฺฏุงู ููุฑูโุง |
| ๐ฅ BRONZE | 5% | ุชุฎูู ูพุงู ุจุฑุง ููุงูุฏฺฏุงู ุจุฑูุฒ |

---

## ๐ API Endpoints

### 1๏ธโฃ ูุฏุฑุช ุณูุณููโูุฑุงุชุจ (Hierarchy Management)

#### ูุณุช ููุงูุฏฺฏุงู ฺฉุงุฑุฎุงูู
```http
GET /api/hierarchy/agents
Authorization: Bearer <token>
```

**Response:**
```json
{
  "success": true,
  "data": [
    {
      "id": "org_123",
      "name": "ููุงูุฏฺฏ ุชูุฑุงู",
      "tierLevel": "GOLD",
      "creditLimit": 1000000000,
      "currentDebt": 250000000,
      "discountPercentage": 5,
      "isActive": true,
      "members": [...]
    }
  ]
}
```

#### ุงุฌุงุฏ ููุงูุฏู ุฌุฏุฏ
```http
POST /api/hierarchy/agents
Authorization: Bearer <token>
Content-Type: application/json

{
  "name": "ููุงูุฏฺฏ ุงุตููุงู",
  "mobile": "09123456789",
  "email": "isfahan@example.com",
  "tierLevel": "SILVER",
  "creditLimit": 500000000,
  "discountPercentage": 3
}
```

#### ูุณุช ูุฌุฑุงู ููุงูุฏู
```http
GET /api/hierarchy/executors
Authorization: Bearer <token>
```

#### ุงุฌุงุฏ ูุฌุฑ ุฌุฏุฏ
```http
POST /api/hierarchy/executors
Authorization: Bearer <token>
Content-Type: application/json

{
  "name": "ุนู ูุญูุฏ",
  "mobile": "09191234567",
  "specialty": "PLUMBER"
}
```

### 2๏ธโฃ ูุญุตููุงุช B2B ุจุง ููุช ฺูุฏูุงู

```http
GET /api/b2b/products
Authorization: Bearer <token>
```

**Response:**
```json
{
  "success": true,
  "data": {
    "products": [
      {
        "id": "prod_123",
        "name": "ุดุฑ ุขูุงุช",
        "price": 1000000,
        "pricing": {
          "finalPrice": 750000,
          "basePrice": 1000000,
          "tierLevel": "GOLD",
          "totalDiscount": 25
        }
      }
    ]
  }
}
```

### 3๏ธโฃ ูพุดโูุงฺฉุชูุฑ (Proforma)

```http
POST /api/b2b/proforma
Authorization: Bearer <token>
Content-Type: application/json

{
  "items": [
    {
      "productId": "prod_123",
      "quantity": 10
    }
  ],
  "notes": "ุณูุงุฑุด ููุฑ"
}
```

---

## ๐ฅ๏ธ ุตูุญุงุช Frontend

### 1. ูพูู ฺฉุงุฑุฎุงูู - ูุฏุฑุช ููุงูุฏฺฏุงู
**ูุณุฑ:** `/panel/factory/agents`

**ูฺฺฏโูุง:**
- ๐ ูุณุช ุชูุงู ููุงูุฏฺฏุงู
- โ ุงูุฒูุฏู ููุงูุฏู ุฌุฏุฏ
- ๐ฏ ุชุนู ุณุทุญ ููุช (GOLD/SILVER/BRONZE)
- ๐ฐ ุชุนู ุณูู ุงุนุชุจุงุฑ
- ๐ ููุงุด ุจุฏู ูุนู

### 2. ฺฉุงุชุงููฺฏ ูุญุตููุงุช B2B
**ูุณุฑ:** `/panel/catalog`

**ูฺฺฏโูุง:**
- ๐๏ธ ููุงุด ูุญุตููุงุช ุจุง ููุช ูฺู ููฺฉุงุฑ
- ๐ฒ ููุช ุงุตู ุฎุทโุฎูุฑุฏู
- ๐ท๏ธ ููุงุด ุฏุฑุตุฏ ุชุฎูู
- ๐ฅ ูุดุงู ุณุทุญ ููุงูุฏฺฏ

### 3. ูพูู ุฎุฑุฏ ุณุฑุน ูุฌุฑ
**ูุณุฑ:** `/panel/executor/quick-order`

**ูฺฺฏโูุง:**
- ๐ ุฌุฏูู ูุญุตููุงุช ุนูุฏูโูุฑูุด
- ๐ข ูุฑูุฏ ุณุฑุน ุชุนุฏุงุฏ
- ๐ ุตุฏูุฑ ูพุดโูุงฺฉุชูุฑ ุจุง ฺฉ ฺฉูฺฉ
- ๐ฐ ูุญุงุณุจู ุฎูุฏฺฉุงุฑ ูุจูุบ ฺฉู

---

## ๐ฏ ูุญูู ุงุณุชูุงุฏู

### ุจุฑุง ฺฉุงุฑุฎุงูู:

1. **ูุฑูุฏ ุจู ูพูู ฺฉุงุฑุฎุงูู:**
   ```
   /panel/factory/agents
   ```

2. **ุงูุฒูุฏู ููุงูุฏู:**
   - ฺฉูฺฉ ุฑู "โ ุงูุฒูุฏู ููุงูุฏู ุฌุฏุฏ"
   - ูุงุฑุฏ ฺฉุฑุฏู ูุงูุ ููุจุงู
   - ุงูุชุฎุงุจ ุณุทุญ ููุช (ุทูุง/ููุฑูโุง/ุจุฑูุฒ)
   - ุชุนู ุณูู ุงุนุชุจุงุฑ
   - ุฐุฎุฑู

3. **ููุงูุฏู ฺฉ ุฑูุฒ ูููุช ุฏุฑุงูุช ูโฺฉูุฏ** (ุฏุฑ production ุงุฒ SMS ุงุณุชูุงุฏู ุดูุฏ)

### ุจุฑุง ููุงูุฏู:

1. **ูุฑูุฏ ุจุง ููุจุงู ู ุฑูุฒ:**
   ```
   /auth/login
   ```

2. **ูุดุงูุฏู ฺฉุงุชุงููฺฏ ูุญุตููุงุช:**
   ```
   /panel/catalog
   ```

3. **ููุชโูุง ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุจุง ุชุฎูู ููุงุด ุฏุงุฏู ูโุดููุฏ**

### ุจุฑุง ูุฌุฑ:

1. **ูุฑูุฏ ุจู ูพูู ุณูุงุฑุด ุณุฑุน:**
   ```
   /panel/executor/quick-order
   ```

2. **ุงูุชุฎุงุจ ูุญุตููุงุช ู ุชุนุฏุงุฏ:**
   - ุฏุฑ ุฌุฏููุ ุชุนุฏุงุฏ ูุฑ ูุญุตูู ุฑุง ูุงุฑุฏ ฺฉูุฏ
   - ููุช ฺฉู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ูุญุงุณุจู ูโุดูุฏ

3. **ุตุฏูุฑ ูพุดโูุงฺฉุชูุฑ:**
   - ฺฉูฺฉ ุฑู "๐ ุตุฏูุฑ ูพุดโูุงฺฉุชูุฑ"
   - ูพุดโูุงฺฉุชูุฑ ุจุฑุง ุนูุฏูโูุฑูุด ุงุฑุณุงู ูโุดูุฏ

---

## ๐พ ูุฏู ุฏุงุฏู

### Organization (ุณุงุฒูุงู)
```prisma
model Organization {
  id          String              @id @default(cuid())
  name        String
  type        OrganizationType    // FACTORY | AGENT | RETAILER
  nationalId  String              @unique
  // ...
}
```

### B2BRelation (ุฑุงุจุทู B2B)
```prisma
model B2BRelation {
  id                  String      @id
  supplierId          String      // ฺฉุงุฑุฎุงูู
  buyerId             String      // ููุงูุฏู
  tierLevel           DealerTier  // GOLD | SILVER | BRONZE
  creditLimit         Decimal
  currentDebt         Decimal
  discountPercentage  Decimal
  // ...
}
```

### User (ฺฉุงุฑุจุฑ)
```prisma
model User {
  id              String    @id
  role            UserRole  // EXECUTOR | SELLER | ...
  organizationId  String?
  executorProfile ExecutorProfile?
  // ...
}
```

---

## ๐ ุงุญุฑุงุฒ ููุช

ุชูุงู APIูุง ูุงุฒ ุจู JWT Token ุฏุงุฑูุฏ:

```javascript
headers: {
  'Authorization': `Bearer ${token}`
}
```

Token ุฑุง ูโุชูุงูุฏ ุงุฒ `/api/auth/login` ุฏุฑุงูุช ฺฉูุฏ.

---

## ๐ฑ Responsive Design

ุชูุงู ุตูุญุงุช ุจุฑุง ููุจุงูุ ุชุจูุช ู ุฏุณฺฉุชุงูพ ุจููู ุดุฏูโุงูุฏ:

- ๐ฑ Mobile: ุฌุฏููโูุง Scroll ูโุดููุฏ
- ๐ป Desktop: ููุงุด ฺฉุงูู ุฌุฏุงูู
- ๐จ Tailwind CSS ุจุฑุง ุงุณุชุงูโุฏู

---

## ๐ ูุฑุงุญู ุจุนุฏ

- [ ] ุงุถุงูู ฺฉุฑุฏู ููุชุฑ ู ุฌุณุชุฌู ุจู ฺฉุงุชุงููฺฏ
- [ ] ููุชูฺฉุดู SMS ุจุฑุง ุฑูุฒูุง ุนุจูุฑ ูููุช
- [ ] ูพูู ฺฏุฒุงุฑุดโฺฏุฑ ุจุฑุง ฺฉุงุฑุฎุงูู
- [ ] ุชุงุฑุฎฺู ุณูุงุฑุดุงุช ูุฌุฑ
- [ ] ุณุณุชู ุชุงุฏ ูพุดโูุงฺฉุชูุฑ ุชูุณุท ููุงูุฏู

---

## ๐ ุฑูุน ูุดฺฉูุงุช

### "Unauthorized" error
- ุจุฑุฑุณ ฺฉูุฏ Token ูุนุชุจุฑ ุงุณุช
- Token ุฑุง ุงุฒ localStorage ุฏุฑุงูุช ฺฉูุฏ: `localStorage.getItem('token')`

### ูุญุตููุงุช ููุงุด ุฏุงุฏู ููโุดููุฏ
- ุจุฑุฑุณ ฺฉูุฏ ฺฉุงุฑุจุฑ ุจู Organization ูุชุตู ุงุณุช
- ุจุฑุฑุณ ฺฉูุฏ B2BRelation ูุนุงู ุงุณุช

### ููุชโูุง ูฺู ููุงุด ุฏุงุฏู ููโุดููุฏ
- ุจุฑุฑุณ ฺฉูุฏ `tierLevel` ุฏุฑ B2BRelation ุชูุธู ุดุฏู ุงุณุช
- ุจุฑุฑุณ ฺฉูุฏ PriceList ูุนุงู ุงุณุช

---

## ๐ ูพุดุชุจุงู

ุจุฑุง ุณูุงูุงุช ู ูุดฺฉูุงุช:
- ๐ง Email: support@nextgen-market.ir
- ๐ฑ Telegram: @nextgen_support
