services:
  postgres:
    profiles: ["prod"]
    deploy:
      resources:
        limits:
          cpus: ${POSTGRES_CPU_LIMIT:-1.0}
          memory: ${POSTGRES_MEM_LIMIT:-1024M}
        reservations:
          cpus: ${POSTGRES_CPU_RESERVATION:-0.5}
          memory: ${POSTGRES_MEM_RESERVATION:-512M}

  redis:
    profiles: ["prod"]
    deploy:
      resources:
        limits:
          cpus: ${REDIS_CPU_LIMIT:-1.0}
          memory: ${REDIS_MEM_LIMIT:-512M}
        reservations:
          cpus: ${REDIS_CPU_RESERVATION:-0.25}
          memory: ${REDIS_MEM_RESERVATION:-256M}

  minio:
    profiles: ["prod"]
    deploy:
      resources:
        limits:
          cpus: ${MINIO_CPU_LIMIT:-1.0}
          memory: ${MINIO_MEM_LIMIT:-1024M}
        reservations:
          cpus: ${MINIO_CPU_RESERVATION:-0.5}
          memory: ${MINIO_MEM_RESERVATION:-512M}

  api:
    profiles: ["prod"]
    deploy:
      resources:
        limits:
          cpus: ${API_CPU_LIMIT:-1.0}
          memory: ${API_MEM_LIMIT:-1024M}
        reservations:
          cpus: ${API_CPU_RESERVATION:-0.5}
          memory: ${API_MEM_RESERVATION:-512M}

  web:
    profiles: ["prod"]
    deploy:
      resources:
        limits:
          cpus: ${WEB_CPU_LIMIT:-1.0}
          memory: ${WEB_MEM_LIMIT:-1024M}
        reservations:
          cpus: ${WEB_CPU_RESERVATION:-0.5}
          memory: ${WEB_MEM_RESERVATION:-512M}

  admin:
    profiles: ["prod"]
    deploy:
      resources:
        limits:
          cpus: ${ADMIN_CPU_LIMIT:-0.5}
          memory: ${ADMIN_MEM_LIMIT:-512M}
        reservations:
          cpus: ${ADMIN_CPU_RESERVATION:-0.25}
          memory: ${ADMIN_MEM_RESERVATION:-256M}

  worker:
    profiles: ["prod"]
    deploy:
      resources:
        limits:
          cpus: ${WORKER_CPU_LIMIT:-1.0}
          memory: ${WORKER_MEM_LIMIT:-1024M}
        reservations:
          cpus: ${WORKER_CPU_RESERVATION:-0.5}
          memory: ${WORKER_MEM_RESERVATION:-512M}
